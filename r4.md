### Bluetooth

### 4.6.1 Arquitectura de Bluetooth

Una piconet es un sistema TDM centralizado, en el cual el maestro controla el reloj y determina qué dispositivo se comunica en un momento determinado. Todas las comunicaciones se realizan entre el maestro y el esclavo. La razón para el diseño maestro/esclavo es que los diseñadores querían facilitar la implementación de chips Bluetooth completos por debajo de 5 dólares. La unidad básica de un sistema Bluetooth es una piconet, que consta de un nodo maestro y hasta siete nodos esclavos activos a una distancia de 10 metros. En una misma sala pueden encontrarse varias piconets y se pueden conectar mediante un nodo puente, además, un conjunto de piconets interconectadas se denomina scatternet. puede haber hasta 255 nodos estacionados en la red, que son dispositivos que el nodo maestro ha cambiado a un estado de bajo consumo de energía para reducir el desgaste innecesario de sus pilas.

### 4.6.2 Aplicaciones de Bluetooth

El perfil de acceso genérico ofrece una manera para establecer y mantener enlaces seguros entre el maestro y los esclavos. El descubrimiento de servicios lo utilizan para descubrir qué servicios ofrecen otros dispositivos. El perfil de puerto serie emula una línea serie y es especialmente útil para aplicaciones heredadas que requieren una línea serie. El perfil de intercambio genérico define una relación cliente-servidor para el traslado de datos. El perfil de acceso a LAN permite a un dispositivo Bluetooth conectarse a una red fija, el perfil de acceso telefónico a redes permite a una computadora portátil conectarse a un teléfono móvil que contenga un módem integrado, sin necesidad de cables. El perfil de fax posibilita a máquinas de fax inalámbricas enviar y recibir faxes a través de teléfonos móviles sin que exista una conexión por cable entre ambos. El perfil de telefonía inalámbrica proporciona una manera de conectar el handset de un teléfono inalámbrico a la estación base, el perfil intercom hace posible que dos teléfonos se conecten como walkie-talkies. Con el perfil headset se puede realizar comunicación de voz entre la diadema telefónica y su estación base. Los tres perfiles restantes sirven para intercambiar objetos entre dos dispositivos inalámbricos, como tarjetas de presentación, imágenes o archivos de datos.

### 4.6.3 La pila de protocolos de Bluetooth

Bluetooth cuenta con muchos protocolos agrupados con poco orden en capas, donde la estructura de capas no sigue el modelo OSI, el modelo TCP/IP, el modelo 802 o algún otro modelo conocido. El IEEE se encuentra modificándolo para ajustarlo al modelo 802. La capa inferior es la capa de radio física, que se ocupa de la transmisión y la modulación de radio. El objetivo es lograr que el sistema tenga un costo bajo para que pueda entrar al mercado masivo. La capa de banda base tiene algunos puntos en común con la subcapa MAC, aunque también incluye elementos de la capa física y se encarga de la manera en que el maestro controla las ranuras de tiempo y de que éstas se agrupen en tramas.

Luego se encuentra una capa con un grupo de protocolos relacionados. El administrador de enlaces se encarga de establecer canales lógicos entre dispositivos, incluyendo administración de energía, autenticación y calidad de servicio. El protocolo de adaptación y control de enlaces lógicos aísla a las capas superiores de los detalles de la transmisión. Los protocolos de audio y control se encargan del audio y el control. La capa de middleware contiene una mezcla de diferentes protocolos. Los protocolos RFcomm, de telefonía y de descubrimiento de servicios son nativos. RFcomm es el protocolo que emula el puerto serie estándar de las PCs para la conexión de dispositivos y su propósito es permitir que dispositivos heredados lo utilicen con facilidad. El protocolo de telefonía es de tiempo real y el protocolo de descubrimiento de servicios se emplea para localizar servicios dentro de la red. En la capa superior es donde se ubican las aplicaciones y los perfiles, que utilizan a los protocolos de las capas inferiores para realizar su trabajo. Cada aplicación tiene su propio subconjunto dedicado de protocolos.

### 4.6.4 La capa de radio de Bluetooth

La capa de radio traslada los bits del maestro al esclavo, o viceversa. Es un sistema de baja potencia con un rango de 10 metros que opera en la banda ISM de 2.4 GHz. Para asignar los canales de manera equitativa, el espectro de saltos de frecuencia se utiliza a 1600 saltos por segundo y un tiempo de permanencia de 625 µseg. Todos los nodos de una piconet saltan de manera simultánea, y el maestro establece la secuencia de salto. Ya que el 802.11 como Bluetooth operan en la banda ISM de 2.4 GHz en los mismos 79 canales, interfieren entre sí y por esto algunas empresas han recurrido a la prohibición total de Bluetooth para solucionar el problema.

### 4.6.5 La capa de banda base de Bluetooth

Es lo más parecido a una subcapa MAC. Esta capa convierte el flujo de bits puros en tramas y define algunos formatos clave, el maestro de cada piconet define una serie de ranuras de tiempo de 625 µseg y las transmisiones del maestro empiezan en las ranuras pares, y las de los esclavos, en las ranuras impares. La sincronización de saltos de frecuencia permite un tiempo de asentamiento de 250-260 µseg por salto para que los circuitos de radio se estabilicen. Cada trama se transmite por un canal lógico, llamado enlace, entre el maestro y un esclavo. Hay dos tipos de enlaces. El primero es el ACL que se utiliza para datos conmutados en paquetes disponibles a intervalos irregulares. El tráfico ACL se entrega sobre la base de mejor esfuerzo. No hay garantías, las tramas se pueden perder y tienen que retransmitirse. El otro tipo de enlace es el SCO para datos en tiempo real. Las tramas que se envían a través de ellos nunca se retransmiten, se puede utilizar la corrección de errores hacia delante para una confiabilidad alta.

### 4.6.6 La capa L2CAP de Bluetooth

La capa L2CAP tiene tres funciones principales. La primera es aceptar paquetes de hasta 64 KB provenientes de las capas superiores y los divide en tramas para transmitirlos. La segunda es manejar la multiplexión y desmultiplexión de múltiples fuentes de paquetes, la capa determina cuál protocolo de las capas superiores lo manejará, por ejemplo, el RFcomm o el de telefonía. La última es encargarse de la calidad de los requerimientos de servicio, tanto al establecer los enlaces como durante la operación normal.

### 4.6.7 Estructura de la trama de Bluetooth

La estructura más importante empieza con un código de acceso que identifica al maestro, cuyo propósito es que los esclavos que se encuentren en el rango de alcance de dos maestros sepan cuál tráfico es para ellos. Luego un encabezado de 54 bits que contiene campos comunes de la subcapa MAC. Luego está el campo de datos de hasta 2744 bits. En el encabezado, el campo Dirección identifica a cuál de los ocho dispositivos activos está destinada la trama, el campo Tipo indica el tipo de trama, el tipo de corrección de errores que se utiliza en el campo de datos y cuántas ranuras de longitud tiene la trama. El bit A se utiliza para incorporar un ACK en una trama. El bit S sirve para numerar las tramas con el propósito de detectar retransmisiones. El protocolo es de parada y espera, por lo que 1 bit es suficiente y por último la Suma de verificación de 8 bits. El campo de datos siempre es de 240 bits. Se definen tres variantes, que permiten 80, 160 y 240 bits de carga útil real, y el resto se utiliza para corrección de errores.
